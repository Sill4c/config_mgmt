Vagrant.configure("2") do |config|

    # Ansible VM (Ansible szerver)
    config.vm.define "ansible" do |ansible|
      ansible.vm.box = "bento/rockylinux-9"
      ansible.vm.provider "virtualbox" do |vb|
        vb.memory = "1024"
      end
      ansible.vm.network "private_network", ip: "192.168.56.10"
      ansible.vm.hostname = "ansible"
      ansible.vm.synced_folder "./shared", "/shared"
      
      # Provisioning: Telepíti az Ansible-t
      ansible.vm.provision "shell", inline: <<-SHELL
        yum -y update
        yum -y install epel-release
        yum -y install ansible
      SHELL
    end
  
    # Web VM (Web szerver)
    config.vm.define "web" do |web|
      web.vm.box = "bento/rockylinux-9"
      web.vm.provider "virtualbox" do |vb|
        vb.memory = "1024"
      end
      web.vm.network "private_network", ip: "192.168.56.11"
      web.vm.hostname = "web"
      web.vm.synced_folder "./shared", "/shared"
  
      # Web port forwarding
      web.vm.network "forwarded_port", guest: 80, host: 8888
      
      # Provisioning: Csak a "homework" felhasználó létrehozása és egyéb alap beállítások
      web.vm.provision "shell", inline: <<-SHELL
        useradd homework
        echo "homework:homework" | chpasswd
        echo "homework ALL=(ALL) NOPASSWD: ALL" > /etc/sudoers.d/homework
      SHELL
    end
  end
  